<!-- eslint-disable @angular-eslint/template/interactive-supports-focus -->
<!-- eslint-disable @angular-eslint/template/click-events-have-key-events -->
<div
  class="bg-light d-flex align-items-center justify-content-center min-vh-100 p-4"
>
  <div
    class="bg-white p-4 p-sm-5 p-md-6 rounded-3 shadow-lg w-100 form-fade-in"
    style="max-width: 448px"
  >
    <div class="text-center mb-4">
      <svg
        class="mx-auto text-primary"
        style="width: 4rem; height: 4rem"
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        viewBox="0 0 24 24"
        stroke-width="1.5"
        stroke="currentColor"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"
        />
      </svg>
      <h1 class="h3 fw-bold text-dark mt-3">Welcome Back</h1>
      <p class="text-secondary small mt-1">
        Sign in to continue
      </p>
    </div>

    <form [formGroup]="loginForm" (ngSubmit)="onLoginSubmit()">
      <div class="mb-3">
        <label for="email" class="form-label small fw-medium text-dark">Email or Username</label>
        <input
          type="text"
          id="email"
          formControlName="username"
          class="form-control px-3 py-2 border rounded-3 shadow-sm custom-focus"
          placeholder="you@example.com"
          required
        />
        <div 
          *ngIf="loginForm.get('username')?.invalid && (loginForm.get('username')?.dirty || loginForm.get('username')?.touched)" 
          class="text-danger small mt-1">
          Username/Email is required.
        </div>
      </div>

      <div class="mb-3">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <label for="password" class="form-label small fw-medium text-dark">Password</label>
          <a routerLink="/forgot-password" class="small text-primary text-decoration-none">Forgot Password?</a>
        </div>
        <input
          type="password"
          id="password"
          formControlName="password"
          class="form-control px-3 py-2 border rounded-3 shadow-sm custom-focus"
          placeholder="••••••••"
          required
        />
        <div 
          *ngIf="loginForm.get('password')?.invalid && (loginForm.get('password')?.dirty || loginForm.get('password')?.touched)" 
          class="text-danger small mt-1">
          Password is required.
        </div>
      </div>

      <div id="messageArea" class="mb-3 small text-center min-h-20px">
        <p *ngIf="statusMessage" [class.text-success]="isSuccess" [class.text-danger]="!isSuccess">{{ statusMessage }}</p>
      </div>

      <button
        type="submit"
        id="loginButton"
        class="btn btn-primary w-100 fw-semibold py-3 px-4 rounded-3 shadow-sm custom-button-transition focus-ring"
        [disabled]="loginForm.invalid || isLoading"
      >
        <span id="buttonText" [class.d-none]="isLoading">Login</span>
        <div
          id="buttonSpinner"
          class="spinner-border spinner-border-sm text-white mx-auto"
          role="status"
          [class.d-none]="!isLoading"
        >
          <span class="visually-hidden">Loading...</span>
        </div>
      </button>
    </form>

    <p class="mt-4 text-center small text-secondary">
      Don't have an account?
      <a 
        id="signUpLink"
        class="btn btn-link fw-medium text-primary p-0 align-baseline hover-underline-effect"
        (click)="onClickSignUp()"
      >
        Sign Up
      </a>
    </p>
    <div class="d-flex align-items-center justify-content-center">
      <div id="g_id_onload"
       data-client_id="129395533013-gie56o3q23g1dkchvnr7g88fhdiolhlh.apps.googleusercontent.com"
       data-context="signin"
       data-ux_mode="popup"
       data-login_uri="http://localhost:3000/api/auth/googleSignIn"
       data-itp_support="true">
  </div>
  
  <div class="g_id_signin"
       data-type="icon"
       data-shape="circle"
       data-theme="filled_blue"
       data-text="signin_with"
       data-size="large">
  </div>
    </div>
    </div>

  <div
    class="modal fade"
    id="customModal"
    tabindex="-1"
    aria-labelledby="modalTitle"
    aria-hidden="true"
    [class.show]="isSignUpPopUpOpen"
    [style.display]="isSignUpPopUpOpen ? 'block' : 'none'"
  >
    </div>
  <lib-sign-up
    [isVisible]="isSignUpPopUpOpen"
    (closeModal)="closeSingInPopUp()"
  ></lib-sign-up>
</div>